USE practice;
CREATE TABLE SALESMAN (S_ID int primary key, NAME VARCHAR(20), CITY VARCHAR(20), Earning float);
CREATE TABLE CUSTOMER (C_ID int primary key, CUST_NAME VARCHAR(20), CITY VARCHAR(20), GRADE int, S_ID int, foreign key (S_ID) references SALESMAN(S_ID));
CREATE TABLE ORDERS (ORD_NO int primary key, PURCHASE_AMT int, ORD_DATE varchar(20), C_ID int, S_ID int, foreign key (S_ID) references SALESMAN(S_ID), foreign key (C_ID) references CUSTOMER(C_ID));
INSERT INTO SALESMAN VALUES (1, 'Amit', 'Delhi', 25000);
INSERT INTO SALESMAN VALUES (2, 'Ankit', 'Pune', 15000);
INSERT INTO SALESMAN VALUES (3, 'Chandra', 'Ahmedabad', 10000);
INSERT INTO SALESMAN VALUES (4, 'Monica', 'Delhi', 35000);
INSERT INTO SALESMAN VALUES (5, 'Rohini', 'Bhopal', 25000);
INSERT INTO CUSTOMER VALUES (10, 'Manish', 'Ahmedabad', 100, 1);
INSERT INTO CUSTOMER VALUES (11, 'Nishanth', 'Chennai', 300, 1);
INSERT INTO CUSTOMER VALUES (12, 'Guru', 'Delhi', 400, 2);
INSERT INTO CUSTOMER VALUES (13, 'Sonia', 'Delhi', 200, 2);
INSERT INTO CUSTOMER VALUES (14, 'Sakshi', 'Lucknow', 400, 3);
INSERT INTO ORDERS VALUES (1, 5000, '04-MAY-17', 10, 1);
INSERT INTO ORDERS VALUES (2, 450, '20-JAN-17', 10, 2);
INSERT INTO ORDERS VALUES (3, 1000, '24-FEB-17', 13, 2);
INSERT INTO ORDERS VALUES (4, 35000, '13-APR-17', 14, 3);
INSERT INTO ORDERS VALUES (5, 550, '09-MAR-17', 12, 2);
SELECT * from SALESMAN;
SELECT * from CUSTOMER;
SELECT * from ORDERS;
SELECT GRADE, count(DISTINCT (C_ID)) FROM CUSTOMER GROUP BY GRADE HAVING GRADE > (SELECT AVG(GRADE) FROM CUSTOMER WHERE CITY='Delhi');
SELECT S_ID, NAME FROM SALESMAN A WHERE (SELECT COUNT(*) FROM CUSTOMER WHERE S_ID=A.S_ID) > 1;
SELECT SALESMAN.S_ID, NAME, CUST_NAME, Earning FROM SALESMAN, CUSTOMER WHERE SALESMAN.CITY = CUSTOMER.CITY UNION SELECT S_ID, NAME, 'NO MATCH', Earning FROM SALESMAN WHERE NOT CITY = ANY (SELECT CITY FROM CUSTOMER) ORDER BY 2 DESC;